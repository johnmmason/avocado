{% extends "base.html" %}

{% block content %}
    <script type='text/javascript'>
      $(document).ready(function() {
        var max_fields = 11; //number of columns in database
        var wrapperParam = $("#formParamContainer");
        var add_button_param = $("#addParam");
        var x1 = 1; 

        $(add_button_param).click(function(e) {
          var fieldHTML_param = '<div><br><div class="form-group"><a class="btn btn-default pull-right" href="#" id="removeParam">Remove</a><label class="control-label col-sm-2" for="params['+ x1 +'][column]">Choose a column:</label><div><select name="params['+ x1 +'][column]"><option value="week_id">Week ID</option><option value="week">Week</option><option value="price">Price</option><option value="volume">Volume</option><option value="total_4046">Total 4046</option><option value="total_4225">Total 4225</option><option value="total_4770">Total 4770</option><option value="category">Category</option><option value="year">Year</option><option value="region">Region</option></select></div></div><div class="form-group"><label class="control-label col-sm-2" for="params['+ x1 +'][type]">Choose a type:</label><div><select name="params['+ x1 +'][type]"><option value="equals">Equal to</option><option value="greater_than">Greater than</option><option value="greater_equal">Greater than or equal to</option><option value="less_than">Less than</option><option value="less_equal">Less than or equal to</option></select></div></div><div class="form-group"><label class="control-label col-sm-2" for="params['+ x1 +'][value]">Value:</label><div class="col-sm-10"><input type="text" class="form-control" name="params['+ x1 +'][value]"></div></div></div>';
          e.preventDefault();
          if (x1 < max_fields) {
              x1++;
              $(wrapperParam).append(fieldHTML_param); //add input boxes
          } else {
              alert('You Reached the limits')
          }
        });

        $(wrapperParam).on("click", "#removeParam", function(e) {
            e.preventDefault();
            $(this).parent('div').parent('div').remove();
            x1--;
        })
      });
    </script> 
    <div class="container">
      <h2>Update Form</h2>
      <br>
      <p>Select a column from the database, a type operator, and the value of that column you are looking for. Then in the update with section, choose desired columns to update and the value to update that column with. All entries fitting that criteria will be updated in the postgres database. Adding multiple parameters will only update entries that meet all the criteria entered.</p>
      <br>
      <br>
      <h4>Update Parameters</h4>
      <br>
      <form class="form-horizontal" action="https://isp-proxy.tacc.utexas.edu/phart/jobs" method="post">  
        <div id="formParamContainer">
          <input type="hidden" id="job_type" name="job_type" value="update">
          <a class="btn btn-default" href="#" id="addParam">Add Parameter</a>
          <br>
          <br>
          <div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="params[0][column]">Choose a column:</label>
              <div>
                <select name="params[0][column]">
                  <option value="week_id">Week ID</option>
                  <option value="week">Week</option>
                  <option value="price">Price</option>
                  <option value="volume">Volume</option>
                  <option value="total_4046">Total 4046</option>
                  <option value="total_4225">Total 4225</option>
                  <option value="total_4770">Total 4770</option>
                  <option value="category">Category</option>
                  <option value="year">Year</option>
                  <option value="region">Region</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="params[0][type]">Choose a type:</label>
              <div>
                <select name="params[0][type]">
                  <option value="equals">Equal to</option>
                  <option value="greater_than">Greater than</option>
                  <option value="greater_equal">Greater than or equal to</option>
                  <option value="less_than">Less than</option>
                  <option value="less_equal">Less than or equal to</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="params[0][value]">Value:</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" name="params[0][value]">
              </div>
            </div>
          </div> 
        </div>
        <div class="form-group">        
          <div class="col-sm-offset-2 col-sm-10">
            <button type="submit" class="btn btn-default">Submit</button>
          </div>
        </div>
      </form>
    </div>    
{% endblock %}
