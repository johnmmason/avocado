{% extends "base.html" %}

{% block content %}
    <script type='text/javascript'>
      $(document).ready(function() {
        var max_fields = 11; //number of columns in database
        var wrapper = $("#formContainer");
        var add_button = $("#addParam");
        var x = 1; 

        $(add_button).click(function(e) {
          var fieldHTML = '<div><br><div class="form-group"><a class="btn btn-default pull-right" href="#" id="remove">Remove</a><label class="control-label col-sm-2" for="params['+ x +'][column]">Choose a column:</label><div><select name="params['+ x +'][column]"><option value="week_id">Week ID</option><option value="week">Week</option><option value="price">Price</option><option value="volume">Volume</option><option value="total_4046">Total 4046</option><option value="total_4225">Total 4225</option><option value="total_4770">Total 4770</option><option value="category">Category</option><option value="year">Year</option><option value="region">Region</option></select></div></div><div class="form-group"><label class="control-label col-sm-2" for="params['+ x +'][type]">Choose a type:</label><div><select name="params['+ x +'][type]"><option value="equals">Equal to</option><option value="greater_than">Greater than</option><option value="greater_equal">Greater than or equal to</option><option value="less_than">Less than</option><option value="less_equal">Less than or equal to</option></select></div></div><div class="form-group"><label class="control-label col-sm-2" for="params['+ x +'][value]">Value:</label><div class="col-sm-10"><input type="text" class="form-control" name="params['+ x +'][value]"></div></div></div>';
          e.preventDefault();
          if (x < max_fields) {
              x++;
              $(wrapper).append(fieldHTML); //add input boxes
          } else {
              alert('You Reached the limits')
          }
        });

        $(wrapper).on("click", "#remove", function(e) {
            e.preventDefault();
            $(this).parent('div').parent('div').remove();
            x--;
        })
      });
    </script> 
    <div class="container">
      <h2>Delete Form</h2>
      <br>
      <p>Select a column from the database, a type operator, and the value of that column you are looking for. All entries fitting that criteria will be deleted from the postgres database. Adding multiple parameters will only delete entries that meet all the criteria you enter.</p>
      <br>
      <form class="form-horizontal" action="https://isp-proxy.tacc.utexas.edu/phart/jobs" method="post">
        <div id="formContainer">
          <input type="hidden" id="job_type" name="job_type" value="delete">
          <a class="btn btn-default" href="#" id="addParam">Add Parameter</a>
          <br>
          <br>
          <div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="params[0][column]">Choose a column:</label>
              <div>
                <select name="params[0][column]">
                  <option value="week_id">Week ID</option>
                  <option value="week">Week</option>
                  <option value="price">Price</option>
                  <option value="volume">Volume</option>
                  <option value="total_4046">Total 4046</option>
                  <option value="total_4225">Total 4225</option>
                  <option value="total_4770">Total 4770</option>
                  <option value="category">Category</option>
                  <option value="year">Year</option>
                  <option value="region">Region</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="params[0][type]">Choose a type:</label>
              <div>
                <select name="params[0][type]">
                  <option value="equals">Equal to</option>
                  <option value="greater_than">Greater than</option>
                  <option value="greater_equal">Greater than or equal to</option>
                  <option value="less_than">Less than</option>
                  <option value="less_equal">Less than or equal to</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="params[0][value]">Value:</label>
              <div class="col-sm-10">
                <input type="text" class="form-control" name="params[0][value]">
              </div>
            </div>
          </div> 
        </div>
        <div class="form-group">        
          <div class="col-sm-offset-2 col-sm-10">
            <button type="submit" class="btn btn-default">Submit</button>
          </div>
        </div>
      </form>
    </div>    
{% endblock %}
